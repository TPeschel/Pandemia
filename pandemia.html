<!DOCTYPE = HTML>
<html>
	<head>
		<title>
			PANDEMIC DISEASE SIMULATIONS
		</title>
		<script src="iterasures.js" type="text/javascript"></script>
		<script src="plot2d.js" type="text/javascript"></script>
		<script src="pandemia.js" type="text/javascript"></script>
		<!-- <link rel="stylesheet" type="text/css" href="corona.css"> -->
		<style>
			body {
				background-color : #383838;
				color : #a0a0a0;
			}
		  canvas {
				background-color : #ffffff;
				border: 1px solid black;
				padding: 5px;
				width:99%;
				height:94%;
				border-spacing: 15px;
				text-align: center;
				position: relative;
			}
		</style>
	</head>
	<body>
		<p>
		  PANDEMIC DISEASE SIMULATIONS
		</p>
	  <div>
	    <canvas id="cnvs">
	      no html 5 supported
  	  </canvas>
	  </div>
		<script type="text/javascript">

		  let
		  pan = new Pandemic( "cnvs", count_of_humans_x = 14, count_of_humans_y = 7, radius = .020, velocity = .0011, acceleration = 1.e-7, sicktime = 1000 );

		  let
		  t_id = 0,
		  st = 200.
		  t    = [ ],
		  heal = [ ],
		  sick = [ ],
		  reco = [ ],
		  dead = [ ],
			updt = function ( ) {

		    if( 0 < pan.state( )[ 1 ] )

  				requestAnimationFrame ( updt );

				updPan ( );
			},

		  pan.bcol ( "#404040", "202020");

			pan.fcol ( "#808080", "#606060" );

	    pan.fnt ( "12pt Calibri" );

		  updPan = function ( ) {

		    pan.accelerate( );

		    pan.move( );

        let
		    state = pan.state( );

		    t.push( 0 < t.length ? t[ t.length - 1 ] + 1 : 0 );
		    heal.push( state[ 0 ] );
		    sick.push( state[ 1 ] );
		    reco.push( state[ 2 ] );
		    dead.push( state[ 3 ] );

		    let
		    nul = arr( heal.length ),
        	top = arr( heal.length, cst( pan.hmn.length + 10 ) ),
        	sr = rel( rAdd, sick, reco ),
		    srd = rel( rAdd, sr, dead ),
		    srdh = rel( rAdd, srd, heal );

		    t_id = t_id < 10. * st ? t_id + 1 : 0;

/*		    d = document.getElementById( "lout1" );

		    d.innerHTML = "healthy: " + state[ 0 ].toString( ) + "<br>sick:" + state[ 1 ].toString( ) + "<br>recovered: " + state[ 2 ].toString( ) + "<br>dead: " + state[ 3 ].toString( );

        d = document.getElementById( "lout2" );

		    d.innerHTML = "healthy: " + state[ 0 ].toString( ) + "<br>sick:" + state[ 1 ].toString( ) + "<br>recovered: " + state[ 2 ].toString( ) + "<br>dead: " + state[ 3 ].toString( );
*/
    	    plot2d = new Plot2d( "cnvs" );

		    plot2d.bcol ( "#808080" );

		    plot2d.fcol ( "#808080" );
		    plot2d.addYX ( nul, t );

		    plot2d.fcol ( "#808080" );
		    plot2d.addYX ( top, t );

		    plot2d.fcol ( "#00ff00" );
		    plot2d.addYX ( srdh, t );

		    plot2d.fcol ( "#000000" );
		    plot2d.addYX ( srd, t );

		    plot2d.fcol ( "#ffff00" );
		    plot2d.addYX ( sr, t );

		    plot2d.fcol ( "#ff0000" );
		    plot2d.addYX ( sick, t );

	        plot2d.fcol ( "#a0a0a0", "#f0f0f0" );
			plot2d.fnt ( "12pt Calibri" );
				//plot2d.grid ( );

        pan.draw ( );
				plot2d.draw ( );
      };

		requestAnimationFrame ( updt );

    </script>
	</body>
</html>
